# 银行账单数据分析系统

一个专业的银行流水账单分析工具，支持工商银行CSV数据的全面财务分析和可视化。

## 📊 功能特点

- 🔍 **智能数据处理** - 自动清洗和预处理银行流水数据
- 📈 **多维度分析** - 收支统计、趋势分析、类别分析
- 📊 **可视化图表** - 自动生成6种专业图表
- 📁 **文件管理** - 智能识别多个CSV文件，一键选择分析
- 💾 **结果保存** - 所有分析结果保存为文件（文本报告+数据表格+图表）
- 🎨 **中文支持** - 完美支持中文显示，无乱码问题

## 🚀 快速开始

### 1. 环境准备

```bash
# 安装依赖 (根据你的pip版本输入‘pip'或者'pip3')
pip install pandas numpy matplotlib seaborn

# 下载项目
git clone <repository-url>
cd 银行账单分析
```

### 2. 数据准备

#### 步骤1：导出银行流水
1. 登录 [工商银行个人网银](https://mybank.icbc.com.cn/)
2. 进入"我的账户" → "卡列表"→“明细”→“请您选择下载明细的格式”→选择EXCEL格式（.csv）
3. 选择时间范围，导出CSV格式文件

#### 步骤2：预处理CSV文件
导出的CSV文件需要简单处理：

```
原始文件格式：
第1-6行：银行信息头部（需删除）
第7行：交易日期、摘要、交易详情... （作为标题行）
第8行开始：具体交易数据
最后一行：人民币合计（保留，程序自动处理）
```

**处理方法：**
- 用Excel或文本编辑器打开CSV文件
- 删除前6行银行信息
- 保存文件，确保第1行是列标题

#### 步骤3：放置文件
将处理好的CSV文件放在项目目录下。

### 3. 运行分析

#### 最简单的方式：
```bash
python quick_analysis.py
```

#### 完整功能：
```bash
python bank_analysis_improved.py
```

## 📁 数据格式要求(一般不需要修改，工行网站默认导出的文件就行)

CSV文件应包含以下主要列：

| 列名 | 说明 | 示例 |
|------|------|------|
| 交易日期 | YYYY-MM-DD格式 | 2024-01-15 |
| 摘要 | 交易类型 | 消费、转账、奖金 |
| 记账金额(收入) | 收入金额 | 5000.00 |
| 记账金额(支出) | 支出金额 | 1200.50 |
| 余额 | 账户余额 | 50000.00 |
| 对方户名 | 交易对方 | 某某商户 |

## 📊 分析结果

运行后会在 `analysis_results/` 目录生成：

### 📋 分析报告 
- `analysis_report_*.txt` - 完整的文字分析报告

### 📈 数据表格
- `cleaned_data_*.csv` - 清洗后的完整数据
- `monthly_summary_*.csv` - 月度收支汇总
- `yearly_summary_*.csv` - 年度收支汇总
- `income_categories_*.csv` - 收入类别分析
- `expense_categories_*.csv` - 支出类别分析
- `top_income_*.csv` - 最高收入交易
- `top_expense_*.csv` - 最高支出交易

### 📊 可视化图表
- `analysis_charts_*.png` - 包含6个子图的综合分析图表
  - 月度收支趋势
  - 年度收支对比  
  - 支出类别分布
  - 收入类别分布
  - 月度净收入趋势
  - 账户余额变化

## 💡 使用示例

```bash
# 1. 快速分析（推荐）
python quick_analysis.py

# 输出示例：
============================================================
🚀 银行账单数据快速分析
============================================================
📁 发现CSV文件：2023-2024账单.csv
🔄 开始自动分析...
...
🎉 分析完成！
📁 结果保存在：/path/to/analysis_results
📂 已自动打开结果目录
```

## ⚙️ 系统要求

- **Python**: 3.8+
- **操作系统**: Windows / macOS / Linux
- **依赖包**: pandas, numpy, matplotlib, seaborn

## 🔧 常见问题

### Q: CSV文件中文乱码怎么办？
A: 程序已自动处理编码问题，生成的文件使用UTF-8-sig编码，Excel可直接正确打开。

### Q: 支持哪些银行？
A: 目前专为工商银行CSV格式设计，其他银行需要调整数据格式。

### Q: 如何分析多个时间段的数据？
A: 将多个CSV文件放在同一目录，程序会自动列出供选择。

### Q: 图表中文显示有问题？
A: 程序已优化中文字体设置，支持macOS和Windows系统。

## 📝 数据隐私

- 所有数据处理均在本地进行，不会上传任何信息
- 建议在安全环境中运行，妥善保管个人财务数据
- 分析完成后可删除敏感的原始CSV文件

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 许可证

本项目仅用于个人财务分析，不构成投资建议。请根据实际情况谨慎做出财务决策。

---

⭐ 如果这个项目对您有帮助，请给个Star支持一下！ 